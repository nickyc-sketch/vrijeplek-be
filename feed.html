<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Vrijeplek — Plekjes</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
<header class="site container">
  <div></div>
  <div class="brand"><span class="wordmark"><strong>Vrijeplek</strong></span></div>
  <nav><a class="btn business" href="/company.html">⚑ Voor bedrijven</a></nav>
</header>

<main class="container">
  <section class="card">
    <h2 style="text-align:center">Vrije plekjes</h2>
    <div id="list" class="grid"></div>
  </section>
</main>
<div class="toast"></div>

<script>
  const $=q=>document.querySelector(q);
  const fmtDate = ts=> new Date(ts).toLocaleDateString('nl-BE',{weekday:'short',day:'2-digit',month:'short'});
  const fmtTime = ts=> new Date(ts).toLocaleTimeString('nl-BE',{hour:'2-digit',minute:'2-digit'});
  const slots = ()=> JSON.parse(localStorage.getItem('vpbe_slots')||'[]');

  function parseHash(){
    const h = (location.hash||'').replace('#','');
    const params = {};
    h.split('&').forEach(kv=>{
      const [k,v] = kv.split('=');
      if(k) params[k]=decodeURIComponent(v||'');
    });
    return params;
  }

  function render(){
    const list = $('#list');
    const arr = slots().filter(s=> s.end > Date.now()).sort((a,b)=>a.start-b.start);
    list.innerHTML = arr.length ? arr.map(s=> `
      <article class="slot">
        <div class="title">${s.bizName} <span class="chip">${s.sectorName||s.sector}</span></div>
        <div class="meta">📅 ${fmtDate(s.start)} • 📍 ${s.city||''} ${s.zip||''} • 🇧🇪</div>
        <div class="timeband">🕒 ${fmtTime(s.start)} — ${fmtTime(s.end)}</div>
        <div><a class="btn yellow" href="/slot.html#${s.id}">Bekijk & claim</a></div>
      </article>
    `).join('') : '<div class="muted" style="text-align:center">Nog geen plekjes. Voeg er eentje toe via <strong>Voor bedrijven</strong>.</div>';
  }

  render();
  setInterval(render, 15000);
</script>
</body>
</html>
